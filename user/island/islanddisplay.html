<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÂèÉËßÄÂ≥∂Â∂º</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <link rel="icon" type="image/svg" href="https://lh3.googleusercontent.com/d/1x9g9cC2Z3YOQXjplPElgLOtBuKixb6lD">
    <link rel="apple-touch-icon" href="https://lh3.googleusercontent.com/d/1UL5PytrCRj0UFA9yJ2QFKowmTmBw-rZn">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
       /* =========================================
          üèûÔ∏è Êï¥È´îÁâàÈù¢ Overall
          ========================================= */
        body, html {width: 100%; height: 100%;
                    position: fixed;
                    overflow: hidden;
                    background: #1a1a1a; 
                    display: flex; align-items: center; justify-content: center;
                    margin: 0; padding: 0; 
                    overscroll-behavior: none; 
                    touch-action: none; -webkit-user-select: none; -webkit-touch-callout: none; -webkit-user-drag: none;
                    cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='50' height='50' style='font-size:36px'><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle'>‚òÅÔ∏è</text></svg>") 25 25, auto;
        }

       /* =========================================
          üñºÔ∏è 16:9 Â§ñÊ°Ü Frame
          ========================================= */      
        .swiper {width: 1280px; height: 720px;
                 position: relative;
                 flex-shrink: 0;
                 background: #000;
                 transform-origin: center center;}
        .island-stage {width: 100%; height: 100%; background-size: 100% 100%;
                       position: relative;  background-position: center;}
        .swiper-button-next, .swiper-button-prev {color: rgba(255, 255, 255, 0.5) !important; border-radius: 50%; text-shadow: 0 0 10px rgba(0,0,0,0.3);}
        .swiper-button-next:hover, .swiper-button-prev:hover {color: rgba(255, 255, 255, 1) !important; border-radius: 50%; text-shadow: 0 0 10px rgba(0,0,0,0.3);}
        :root {--swiper-pagination-color: white;}
    
      /* =========================================
         üì± ÊâãÊ©üÁâà Layout
         ========================================= */    
      @media (max-width: 932px) {.swiper-button-next::after, .swiper-button-prev::after {font-size: 25px !important;}} 
      
      /* =========================================
         üß∏ Áâ©‰ª∂ Items
         ========================================= */         
        .draggable-display {position: absolute;
                            pointer-events: none; touch-action: none;
                            transform: translate(-50%, -50%);}
        .draggable-display img {width: 100%;
                                display: block;
                                pointer-events: none; touch-action: none; -webkit-touch-callout: none; -webkit-user-drag: none; -webkit-user-select: none; -ms-user-select: none; -moz-user-select: none;}
      /* =========================================
         üîò ÊåâÈàï Button
         ========================================= */            
        a, button, .swiper-button-next, .swiper-button-prev {cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='55' height='55' style='font-size:40px; opacity:0.8'><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle'>üå•Ô∏è</text></svg>") 27 27, pointer !important;}
        .buttons {position: absolute !important; top: 10px; left: 10px; z-index: 100; display: flex; gap: 8px;}
        a:hover, .buttons button:hover {background-color: rgba(255, 255, 255, 0.2); color: rgba(255, 255, 255, 1);}
        .buttons button:hover svg, .buttons button:active svg {stroke: white !important;}
        a:active, .buttons button:active {background-color: rgba(255, 255, 255, 0.3); color: rgba(255, 255, 255, 1); transform: scale(0.95);}
        @media screen and (max-width: 932px) {.buttons {gap: 8px; top: 15px;}
                                              .buttons button {padding: 12px; background: rgba(255, 255, 255, 0.9);}
                                              .buttons button svg {width: 26px !important; height: 26px !important;}}        
    </style>
</head>
  
<body>
    <div class="swiper">
        <div class="buttons">
            <button onclick="window.location.href='../../index.html';" class="bg-white/80 backdrop-blur-md border-[1px] border-white/30 rounded-full shadow-md text-slate-500 p-2" draggable="false" title="ËøîÂõû‰∏ªÈ†Å">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-door-open-icon lucide-door-open"><path d="M11 20H2"/><path d="M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z"/><path d="M11 4H8a2 2 0 0 0-2 2v14"/><path d="M14 12h.01"/><path d="M22 20h-3"/></svg>
            </button>
            <button onclick="window.location.href='island.html';" class="bg-white/80 backdrop-blur-md border-[1px] border-white/30 rounded-full shadow-md text-slate-500 p-2" draggable="false" title="Ë®≠ÂÆöÊ®°Âºè">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pointer-icon lucide-pointer"><path d="M22 14a8 8 0 0 1-8 8"/><path d="M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2"/><path d="M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1"/><path d="M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10"/><path d="M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"/></svg>
            </button>
        </div>
        <div class="swiper-wrapper" id="island-container"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>
  
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>

    // =========================================
    // üåé GAS
    // =========================================
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxpkU2aeSLB46AF_C0mFRPdQGhvOYkkhv3glYeJSLeaM9JRKHPlkU5TPtzD0cyo62Q/exec";
        
    const params = new URLSearchParams(window.location.search);
    const user = params.get('user') || 'Testing';

    // =========================================
    // üèûÔ∏è Â≥∂Â∂ºËÉåÊôØ Island Background
    // =========================================    
    function getBackground(islandId) {
      const bgs = {'island_1': 'https://lh3.googleusercontent.com/d/1j_GFfezO8NNHnF1M-q7euOdDHOdtP8vF',
                   'island_2': 'https://lh3.googleusercontent.com/d/1Roy33fghpQHRS1IZk2N_MxYbY1-YKVRu',
                   'island_3': 'https://lh3.googleusercontent.com/d/15OIBcHpnpYkV1hH4pk64qJjEon-y1plq',
                  };
      return bgs[islandId] || bgs['island_1'];}
    
    // =========================================
    // üîç Á∏ÆÊîæ Scale
    // =========================================          
    function handleResize() {const swiperEl = document.querySelector('.swiper');
                             const designWidth = 1280; const designHeight = 720; const windowWidth = window.innerWidth;const windowHeight = window.innerHeight;
                             const scale = Math.min(windowWidth / designWidth, windowHeight / designHeight);
                             swiperEl.style.transform = `scale(${scale})`;}
    window.addEventListener('resize', handleResize);
    window.addEventListener('load', handleResize);
    handleResize();
   
    // =========================================
    // üöÄ ËºâÂÖ• Load
    // =========================================  
        async function init() {try {const res = await fetch(`${SCRIPT_URL}?user=${encodeURIComponent(user)}`);
                                    const islands = await res.json(); const container = document.getElementById('island-container');
                                    islands.forEach(island => {const slide = document.createElement('div'); slide.className = 'swiper-slide';
                                                               const stage = document.createElement('div'); stage.className = 'island-stage';
                                                               stage.style.backgroundImage = `url('${getBackground(island.islandId)}')`;
                                                               island.items.forEach(item => {const div = document.createElement('div'); div.className = 'draggable-display';
                                                                                             let widthStr = String(item.width);
                                                                                             if (widthStr.includes('%')) {div.style.width = parseFloat(widthStr) + '%';} 
                                                                                             else {const pxValue = parseFloat(widthStr) || 150; div.style.width = (pxValue / 1280 * 100) + '%';}
                                                                                             div.style.left = item.leftPercent + '%'; div.style.top = item.topPercent + '%'; div.style.zIndex = item.isBottom ? "1" : "10";
                                                                                             div.innerHTML = `<img src="${item.url}">`; stage.appendChild(div);});
                                                               slide.appendChild(stage);
                                                               container.appendChild(slide);});
                                    new Swiper('.swiper', {navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
                                                           pagination: { el: '.swiper-pagination', clickable: true },
                                                           on: {resize: function () {this.update();}}});} 
                                catch (e) {console.error("ËºâÂÖ•Â§±Êïó:", e);}}
        init();

    // =========================================
    // ü´µüèª ÊâãÂã¢Á¶ÅÊ≠¢ Disable Gesture
    // =========================================    
      // Â§öÊåáÁ∏ÆÊîæ
      const preventZoom = (e) => {if (e.touches?.length > 1 || (e.type === 'wheel' && (e.ctrlKey || e.metaKey))) {if (e.cancelable) e.preventDefault();}};
      ['touchstart', 'wheel', 'gesturestart'].forEach(type => {document.addEventListener(type, preventZoom, {passive: false});});
      // ÈõôÊìäÁ∏ÆÊîæ
      let lastTouch = 0; document.addEventListener('touchend', (e) => {const now = Date.now(); if (now - lastTouch <= 300) e.preventDefault(); lastTouch = now;}, false);

</script>
</body>
</html>
