<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>è³¼ç‰©ç´€éŒ„</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap">
    <link rel="icon" type="image/webp" href="https://lh3.googleusercontent.com/d/1dEOyNT7D5TQfiV0i2BbfLR6nQIcEylP1">
    <link rel="apple-touch-icon" href="https://lh3.googleusercontent.com/d/1cVkUL5LapuLvtBYyw_CHgejOCflFRYyB">
    <link rel="stylesheet" href="../style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ğŸï¸ æ•´é«” OVERALL */
        body {height: 100vh; width: 100vw; overflow: hidden; margin: 0;
              overscroll-behavior: none; -webkit-user-select: none; -webkit-touch-callout: none;
              font-family: 'Noto Sans TC', sans-serif; background-color: #1dc5fd;
              cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='50' height='50' style='font-size:36px'><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle'>â˜ï¸</text></svg>") 25 25, auto;}
            /* ğŸ™ï¸ èƒŒæ™¯ BACKGROUND */
            .bg-layer {position: fixed; inset: 0; z-index: -1; background-size: cover; background-position: center center; background-repeat: no-repeat; 
                       background-image: url('https://lh3.googleusercontent.com/d/1XB4PQJBN1OIo93GUSkfDm4T8TDSOBQg2');}
            /* ğŸ“± å¹³æ¿èƒŒæ™¯ IPAD BACKGROUND */
            @media screen and (max-width: 800px) {.bg-layer {position: fixed; inset: 0; z-index: -1; background-size: contain; background-position: center center; background-repeat: no-repeat; background-image: url('https://lh3.googleusercontent.com/d/1XB4PQJBN1OIo93GUSkfDm4T8TDSOBQg2');}}
            /* ğŸ“± æ‰‹æ©ŸèƒŒæ™¯ PHONE BACKGROUND */
            @media screen and (max-width: 600px) {.bg-layer {background-size: 100% auto; background-position: center top; background-image: url('https://lh3.googleusercontent.com/d/1OZe9V17SD7onLwgnE2IDiPG2D9KBjqAA');}}

            /* ğŸ• å‹•ç•« ANIMATIONï¼šFADE IN æ·¡å…¥ */
            @keyframes fadeInUp {from {opacity: 0; transform: translateY(20px);} to {opacity: 1; transform: translateY(0);}}
            .record-item {animation: fadeInUp 0.5s ease forwards; opacity: 0;}
        
        /* âš’ï¸ æ“ä½œ OPERATION */
            /* ğŸšï¸ æ²è»¸ SCROLLBAR */
            .custom-scrollbar::-webkit-scrollbar {width: 4px;}
            .custom-scrollbar::-webkit-scrollbar-track {background: transparent;}
            .custom-scrollbar::-webkit-scrollbar-thumb {background: rgba(255,255,255,0.4); border-radius: 10px;}
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="bg-layer"></div>
    <div class="w-full max-w-md h-[80vh] overflow-hidden glass-panel shadow-2xl flex flex-col">
        <div class="p-6 pb-2"><h1 class="pointer-events-none select-none font-cubic text-white text-3xl thick-border tracking-wider mb-1">ğŸ§¾ è³¼ç‰©ç´€éŒ„</h1></div>
        <div id="record-container" class="custom-scrollbar flex-1 overflow-y-auto space-y-4 p-6 pt-2">
            <div class="h-full text-white/80 flex flex-col items-center justify-center space-y-2">
                <div class="animate-spin pointer-events-none select-none text-3xl">ğŸŒ€</div>
                <p class="pointer-events-none select-none font-cubic text-sm thin-border tracking-widest">æ­£åœ¨ç¿»é–±å¸³æœ¬</p>
            </div>
        </div>
        <div class="bg-white/10 text-center p-4">
            <button onclick="window.location.href='downtown.html'" class="select-none bg-white/20 border border-white/20 rounded-full font-cubic text-white text-sm thin-border tracking-wider px-6 py-2 hover:bg-white/30 active:bg-white/30 active:scale-95 transition-all" draggable="false">è¿”å›</button>
        </div>
    </div>
    <script>
        // ğŸŒ GAS
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwZxFMe998Si4keFzPDIUK2ZfMg6Cn1EssDt4FMQTulUwZBI9xQUEI-Va6wnbTrZ1Kb/exec";
        
        // âœ… åŠ è¼‰ LOADING INFO
        window.addEventListener('DOMContentLoaded', () => {const savedName = localStorage.getItem('userID');
                                                           if (!savedName) {window.location.href = '../index.html'; return;}
                                                           fetchHistory(savedName);});
        async function fetchHistory(username) {const container = document.getElementById('record-container');
                                               try {const response = await fetch(`${SCRIPT_URL}?user=${encodeURIComponent(username)}`);
                                                    const data = await response.json();
                                                    if (data.records && data.records.length > 0) {container.innerHTML = ''; 
                                                                                                  const sortedRecords = data.records.reverse();
                                                                                                  sortedRecords.forEach((item, index) => {const card = document.createElement('div');
                                                                                                  card.className = "record-item glass-panel p-4 mb-4";
                                                                                                  card.style.animationDelay = `${index * 0.1}s`;
                                                                                                  card.innerHTML = `
                                                                                                  <div class="flex justify-between items-start">
                                                                                                      <div>
                                                                                                          <h3 class="select-none pointer-events-none font-cubic text-slate-500 text-lg thin-border tracking-wider">${item.itemName}</h3>
                                                                                                          <p class="select-none pointer-events-none font-cubic text-slate-500 text-xs thin-border tracking-wider mt-1">ğŸ“ ${item.location}</p>
                                                                                                      </div>
                                                                                                      <span class="select-none pointer-events-none bg-white/80 rounded-full shadow-sm font-cubic text-cyan-600/80 text-sm thin-border px-3 py-1">x${item.quantity}</span>
                                                                                                  </div>
                                                                                                  <div class="select-none pointer-events-none border-t border-white/25 font-cubic text-white text-[10px] thin-border text-shadow-lg text-right mt-3 pt-2">ğŸ•’ ${item.date}</div>
                                                                                                  `;container.appendChild(card);});} 
                                                    else {container.innerHTML = `
                                                          <div class="h-full text-white/80 flex flex-col items-center justify-center space-y-2">
                                                              <span class="pointer-events-none select-none text-3xl">ğŸ™‚â€â†”ï¸</span>
                                                              <p class="pointer-events-none select-none font-cubic text-sm thin-border tracking-widest">æ²’æœ‰è³¼ç‰©ç´€éŒ„</p>
                                                          </div>`;}}
                                               catch (error) {console.error('Fetch Error:', error); container.innerHTML = `
                                                   <div class="h-full text-white/80 flex flex-col items-center justify-center space-y-2">
                                                       <span class="pointer-events-none select-none text-3xl">âš ï¸</span>
                                                       <p class="pointer-events-none select-none font-cubic text-sm thin-border tracking-widest">é€£ç·šå¤±æ•—</p>
                                                   </div>`;}}
    </script>
</body>
</html>
