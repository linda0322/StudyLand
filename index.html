<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Zung1 Man4</title>
    <link rel="icon" type="image/svg" href="https://lh3.googleusercontent.com/d/1arDtrA_TNi3vbHr7U0bnczMNy3Fz4T2G">
    <link rel="apple-touch-icon" href="https://lh3.googleusercontent.com/d/1361I_r_O_2PR498j6n2Km9TFwMa9XEhH">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ğŸï¸ æ•´é«”ç‰ˆé¢ OVERALL */
        body {height: 100vh; width: 100vw; position: fixed; margin: 0; 
              overflow: hidden; overscroll-behavior: none;
              -webkit-user-select: none; touch-action: none;
              font-family: 'Noto Sans TC', sans-serif;
              background-color: #1dc5fd;            
              cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='50' height='50' style='font-size:36px'><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle'>â˜ï¸</text></svg>") 25 25, auto;
        }
            /* ğŸ™ï¸ èƒŒæ™¯å±¤ BACKGROUND LAYER */
            .bg-layer {position: fixed; inset: 0; z-index: -1;
                       background-size: cover; background-position: center center; background-repeat: no-repeat;
                       background-image: url('https://lh3.googleusercontent.com/d/1WZPUn9UYK1xsLwXmo4QfSr1LG2-poCxc');}
            /* ğŸ“± æ‰‹æ©ŸèƒŒæ™¯ PHONE BACKGROUND LAYER */
            @media screen and (max-width: 600px) {.bg-layer {background-size: 100% auto; background-position: center bottom; background-image: url('https://lh3.googleusercontent.com/d/1OZe9V17SD7onLwgnE2IDiPG2D9KBjqAA');}}
            /* ğŸ“± æ‰‹æ©Ÿæ—‹è½‰æç¤º ORIENTATION NOTI */
            #orientation-noti {display: none; position: fixed; inset: 0; z-index: 99999;
                               background-color: #1dc5fd;
                               flex-direction: column; align-items: center; justify-content: center;}
            @media screen and (max-width: 1000px) and (orientation: landscape) {#orientation-noti {display: flex !important;} body {overflow: hidden !important;}}
            @keyframes phone-portrait {0% { transform: rotate(-90deg); } 30% { transform: rotate(0deg); } 70% { transform: rotate(0deg); } 100% { transform: rotate(-90deg); }}
            .animate-phone-portrait {animation: phone-portrait 3s ease-in-out infinite; transform-origin: center;}
        
        /* ğŸŒ¼ æ¨£å¼ STYLE */
            /* ğŸ¥½ ç»ç’ƒæ¡† */
            .glass-panel {background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.3);}
            /* ğŸ”  å­—é«” FONTS */
            @font-face {font-family: "Cubic11"; src: url('https://cdn.jsdelivr.net/gh/ACh-K/Cubic-11@90bc0e197c4db0fc8c75fe30c2d82dea03da707e/fonts/ttf/Cubic_11.ttf') format('truetype'); font-display: swap;}
            .font-cubic {font-family: 'Cubic11', sans-serif;}
            .thin-border {-webkit-text-stroke: 0.5px currentColor; paint-order: stroke fill;}
            .thick-border {-webkit-text-stroke: 1px currentColor; paint-order: stroke fill;}
        
        /* ğŸ• å‹•ç•« ANIMATION */
            /* ğŸ¤– NPC FLOAT */
            @keyframes float-loop {0%, 100% {transform: translateY(-2px); animation-timing-function: ease-in-out;} 
                                   50% {transform: translateY(2px); animation-timing-function: ease-in-out;}}
            .animate-text-float {animation: float-loop 3s infinite;}
            .npc-float {animation: float-loop 3s infinite; animation-delay: -1.5s; filter: drop-shadow(0 6px 6px rgba(0,0,0,0.1)); transition: filter 1.5s ease-in-out;}
        
        /* âš™ï¸ å…§éƒ¨çµæ§‹ INTERNAL */
            /* â¬‡ï¸ éš±è—éŠæˆ²é¸å–®æ²è»¸ HIDE GAME SCROLLBAR */
            .grid {-ms-overflow-style: none; scrollbar-width: none;
                   -webkit-overflow-scrolling: touch; 
                   overscroll-behavior: contain; 
                   touch-action: pan-y;}
            .grid::-webkit-scrollbar {display: none;}
            /* ğŸ•¹ï¸ éŠæˆ²å…¥å£ GAME ENTRANCE */
            .game-button {display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 1rem; gap: 8px; margin: 0 auto;
                          aspect-ratio: 1 / 1; width: 100%; max-width: 160px; 
                          background-color: rgba(255, 255, 255, 0.95); border-radius: 30px; box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
                          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);}
            .game-icon-container {width: 100%; display: flex; align-items: center; justify-content: center;}
            .game-icon {width: 3rem; height: 3rem; object-fit: contain; border-radius: 0.75rem; pointer-events: none;}
            .game-title {font-family: 'Cubic11', sans-serif; color: #64748b; font-size: 0.875rem; -webkit-text-stroke: 0.5px currentColor; paint-order: stroke fill; text-align: center; letter-spacing: 0.05em;}
            @media screen and (max-width: 600px) {.grid {gap: 20px 10px; padding: 10px;}
                                                  .game-button {padding: 0 !important; background-color: transparent !important; box-shadow: none !important; display: flex; flex-direction: column; align-items: center; overflow: visible;}
                                                  .game-icon-container {width: 100%; aspect-ratio: 1 / 1; background-color: white; border-radius: 22px; overflow: hidden; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); display: flex; align-items: center; justify-content: center; margin-bottom: 8px;}
                                                  .game-icon {width: 100% !important; height: 100% !important; object-fit: cover; border-radius: 0; }
                                                  .game-title {font-size: 0.8rem; color: white !important; -webkit-text-stroke: 0 !important; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); white-space: nowrap; font-weight: 500;}
                                                  .game-button:active {transform: scale(0.9);}
                                                  .game-button:active .game-title {color: white; -webkit-text-stroke: 0;}}
            /* ğŸ”’ å¯†ç¢¼ PASSWORD */
            #notion-pw-input {font-size: 1rem; letter-spacing: 0.3em; text-align: center; vertical-align: middle;}
            #notion-pw-input::placeholder {letter-spacing: normal; -webkit-text-stroke: 0.5px currentColor; font-size: 1rem; text-indent: 0;}     
            @media screen and (max-width: 600px) {#notion-pw-input {font-size: 0.9rem; letter-spacing: 0.2em;}}

        /* âš’ï¸ æ“ä½œ OPERATION */
            /* ğŸ™ˆ éš±è—åœ–å±¤ HIDDEN LAYER */
            .hidden {display: none !important;}
            /* ğŸ«µğŸ» æ‰‹å‹¢ç¦æ­¢ DISABLE GESTURE */
            .no-touch {touch-action: none;
                       -webkit-touch-callout: none; /* Safari é¸å–® */
                       -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; /* é¸å– */
                       -webkit-user-drag: none; /* æ‹–å‹• */}
            /* ğŸ”˜ æŒ‰éˆ•æ•ˆæœ BUTTON EFFECT */
            a, button, [role="button"] {cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='55' height='55' style='font-size:40px; opacity:0.8'><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle'>ğŸŒ¥ï¸</text></svg>") 27 27, pointer !important;}
            button {transition: transform 0.1s ease;} 
            @media (hover: hover) {button:hover, [role="button"]:hover {background-color: rgba(255, 255, 255, 0.2); color: rgba(255, 255, 255, 1);}
                                   .game-button:hover {transform: translateY(-4px); background-color: rgba(255, 255, 255, 0.85);}}
            button:active, [role="button"]:active, .game-button:active {transform: scale(0.95); background-color: rgba(255, 255, 255, 0.3); color: rgba(255, 255, 255, 1)}
            .game-button:active .game-title {color: white; -webkit-text-stroke: 0.5px white;}
    </style>
</head>
<body>
    <!-- ğŸ™ï¸ èƒŒæ™¯åœ– BACKGROUND --><div class="bg-layer"></div>

    <!-- ğŸ“± æ‰‹æ©Ÿæ—‹è½‰æç¤º ORIENTATION NOTI -->
    <div id="orientation-noti">
        <div class="animate-phone-portrait w-20 h-20 flex items-center justify-center mb-6">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>
        </div>
        <h2 class="font-cubic text-xl text-white thick-border tracking-wider">æ—‹è½‰è¢å¹•ä»¥ç¹¼çºŒéŠæˆ²</h2>
    </div>

    <!-- ğŸ“¥ ç™»å…¥ LOGIN -->
        <!-- â¬›ï¸ é®ç½© OVERLAY -->
        <div id="login-overlay" class="no-touch fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex flex-col justify-center items-center p-6">
            <!-- ğŸ’¬ -->
            <div class="no-touch w-full max-w-xs bg-white rounded-[40px] shadow-2xl flex flex-col text-center items-center p-8">
                <img src="https://lh3.googleusercontent.com/d/1dCdxRN0oNjOz5lg7rwajTtYZb077zePp" alt="NPC" class="no-touch pointer-events-none w-20 h-20 mb-6">
                <h2 class="font-cubic text-slate-700 text-xl thick-border tracking-wider mb-4">ç™»å…¥</h2>
                <input type="text" id="username-input" placeholder="è«‹è¼¸å…¥ä½ çš„åå­—" class="w-full border-2 border-slate-100 rounded-2xl font-cubic thin-border text-center px-4 py-4 mb-4 outline-none focus:border-[#38C0FF] transition-all">
                <button id="login-button" class="no-touch w-full bg-[#38C0FF] rounded-2xl font-cubic text-white thin-border px-4 py-4 hover:bg-[#2da9e6] transition-all">é€²å…¥éŠæˆ²</button>
            </div>
        </div>
    
    <!-- âŒ éŒ¯èª¤å½ˆçª— ERROR MODAL -->
        <!-- â¬œï¸ é®ç½© OVERLAY -->
        <div id="error-overlay" class="hidden no-touch fixed inset-0 z-[300] bg-transparent flex flex-col justify-center items-center p-6">
            <!-- ğŸ’¬ -->
            <div class="no-touch max-w-xs bg-slate-200/70 backdrop-blur-sm rounded-[30px] shadow-md flex flex-col text-center items-center p-8 relative">
                <button id="error-close" class="no-touch w-12 h-12 absolute top-4 right-2 text-slate-400 flex text-center justify-center hover:text-slate-600 hover:bg-transparent active:bg-transparent transition-all"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x-icon lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                <h1 class="text-4xl mb-4">ğŸ™ğŸ»</h1>
                <h2 id="login-error" class="font-cubic text-slate-700 text-lg thick-border tracking-wider">...</h2>
            </div>
        </div>

    <!-- ğŸ”’ ç­†è¨˜å¯†ç¢¼ PASSWORD INPUT -->
        <!-- â¬›ï¸ é®ç½© OVERLAY -->
        <div id="password-overlay" class="hidden no-touch fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm flex justify-center items-center p-6">
            <!-- ğŸ’¬ -->
            <div class="no-touch w-full max-w-xs bg-white rounded-[40px] shadow-2xl flex flex-col text-center items-center p-8 relative">
                <h1 class="text-4xl mb-4">ğŸ”’</h1>
                <input type="password" id="notion-pw-input" placeholder="è«‹è¼¸å…¥ç­†è¨˜å¯†ç¢¼" class="w-full border-2 border-slate-100 rounded-2xl font-cubic thin-border text-center px-4 py-4 mb-4 outline-none focus:border-[#38C0FF] transition-all">
                <div class="flex gap-4 w-full">
                    <button id="pw-cancel" class="no-touch flex-1 py-3 bg-slate-200 rounded-2xl font-cubic text-slate-600 thin-border hover:bg-slate-300 transition-all">å–æ¶ˆ</button>
                    <button id="pw-confirm" class="no-touch flex-1 py-3 bg-[#38C0FF] rounded-2xl font-cubic text-white thin-border hover:bg-[#2da9e6] transition-all">ç¢ºå®š</button>
                </div>
            </div>
        </div>

    <!-- ğŸ“¤ ç™»å‡º LOGOUT -->
        <!-- â¬›ï¸ é®ç½© OVERLAY -->
        <div id="logout-modal" class="hidden no-touch fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm flex justify-center items-center p-6">
            <!-- ğŸ’¬ -->
            <div class="no-touch w-full max-w-xs bg-white rounded-[40px] shadow-2xl flex flex-col text-center items-center p-8 ">
                <h2 class="font-cubic text-slate-700 text-xl thick-border tracking-wider mb-4">é€€å‡ºéŠæˆ²</h2>
                <div class="flex gap-4 w-full">
                    <button id="cancel-logout" class="no-touch flex-1 py-3 bg-slate-200 rounded-2xl font-cubic text-slate-600 thin-border hover:bg-slate-300 transition-all">å–æ¶ˆ</button>
                    <button id="confirm-logout" class="no-touch flex-1 py-3 bg-[#38C0FF] rounded-2xl font-cubic text-white thin-border hover:bg-[#2da9e6] transition-all">ç™»å‡º</button>
                </div>
            </div>
        </div>

    <!-- ğŸ‘©ğŸ»â€ğŸ’» ä¸»é  MAIN PAGE -->
    <main id="main-content" class="hidden container flex flex-col items-center mx-auto px-8 py-8">
        <!-- ğŸ” é ‚æ¬„ TOP --><nav class="w-full max-w-[550px] flex justify-between mb-8">
            <!-- â¬…ï¸ å·¦é‚Šç¾¤çµ„ TOP LEFT-->
            <div class="flex items-center gap-2">
                <!-- ğŸ“› ç”¨æˆ·åç¨± USERNAME -->
                <div class="glass-panel rounded-full shadow-md flex items-center px-4 py-1.5 gap-2">
                    <span class="font-cubic text-slate-500 text-[10px] thin-border tracking-wider">ç©å®¶</span><span id="user-display-name" class="font-cubic text-slate-700 text-sm thin-border">è¼‰å…¥ä¸­...</span>
                </div>
                <!-- ğŸ”˜ğŸ“¤ ç™»å‡ºæŒ‰éˆ• LOGOUT BUTTON -->
                <button id="logout-button" class="no-touch glass-panel rounded-full shadow-md text-red-600 p-2" title="ç™»å‡º"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></button>
            </div>
        </nav>
        <!-- ğŸ¤– NPC å‹•ç•« ANIMATION -->
        <header class="flex flex-col items-center text-center mb-6">
            <div class="relative mb-4">
                <img src="https://lh3.googleusercontent.com/d/1dCdxRN0oNjOz5lg7rwajTtYZb077zePp" alt="NPC" class="no-touch pointer-events-none npc-float w-[140px] h-auto drop-shadow-md">
                <div class="absolute -top-1 -right-3 font-cubic text-white text-[22px] thick-border text-shadow-md tracking-widest animate-text-float">GO!</div>
            </div>
        </header>
        <!-- ğŸ•¹ï¸ éŠæˆ²é¸å–® GAME MENU -->
        <div id="grid" class="w-full max-w-[600px] max-h-[60vh] overflow-y-auto grid grid-cols-3 md:grid-cols-4 gap-6 px-6 pt-6 pb-10 -mt-6">            
            <!-- ğŸªª ç©å®¶ USER -->
                <!-- ğŸï¸ æˆ‘çš„å³¶å¶¼ ISLAND -->
                <a id="btn-island" href="user/islandmode.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1x9g9cC2Z3YOQXjplPElgLOtBuKixb6lD" alt="æˆ‘çš„å³¶å¶¼" class="no-touch game-icon"></div>
                    <h3 class="game-title">æˆ‘çš„å³¶å¶¼</h3>
                </a>
                <!-- ğŸ›ï¸ å¤§è¡—å°å·· DOWNTOWN -->
                <a id="btn-downtown" href="user/downtown.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1dEOyNT7D5TQfiV0i2BbfLR6nQIcEylP1" alt="å¤§è¡—å°å··" class="no-touch game-icon"></div>
                    <h3 class="game-title">å¤§è¡—å°å··</h3>
                </a>
                <!-- ğŸ“˜ å­¸ç¿’ç­†è¨˜ NOTION -->
                <button id="btn-notion" class="no-touch game-button hidden">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1530dnP0UbRAxDQaxT1Ry85Fr2Xk1U05d" alt="å­¸ç¿’ç­†è¨˜" class="no-touch game-icon"></div>
                    <h3 class="game-title">å­¸ç¿’ç­†è¨˜</h3>
                </button>
            <!-- ğŸ‘¾ éŠæˆ² GAME -->
                <!-- âœğŸ» å–®å­—ç·´ç¿’ WRITING -->
                <a id="btn-writing" href="game/writing.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1dJz8_GceDg8TAGf3ngz85sHSBlLTbQe5" alt="å–®å­—ç·´ç¿’" class="no-touch game-icon"></div>
                    <h3 class="game-title">å–®å­—ç·´ç¿’</h3>
                </a>
                <!-- ğŸƒ åœ–æ–‡é…å° MATCHING -->
                <a id="btn-matching" href="game/matching.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1XlgAge1T0jE8lxzBtuvvIqvPUMes5nPb" alt="åœ–æ–‡é…å°" class="no-touch game-icon"></div>
                    <h3 class="game-title">åœ–æ–‡é…å°</h3>
                </a>          
        </div>
    </main> 
    <script>
        // ğŸŒ GAS
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwEumd1LFQrap1grNNqL9gywqdlttz9NEIVpRGGtkCTxTWc0Rmzzf1g3OB3c6KCp1iD/exec'; 

        // ğŸ“¥ ç™»å…¥ LOGIN
            // â‡ï¸ å¸¸æ•¸ CONSTANT
            const loginOverlay = document.getElementById('login-overlay'); const usernameInput = document.getElementById('username-input'); const loginBtn = document.getElementById('login-button');
            const errorOverlay = document.getElementById('error-overlay'); const loginErrorText = document.getElementById('login-error'); const closeBtn = document.getElementById('error-close');
            const mainContent = document.getElementById('main-content'); const userDisplayName = document.getElementById('user-display-name');
            // âœ… é©—è­‰ VERIFICATION
            usernameInput.addEventListener('keypress', (e) => {if (e.key === 'Enter') {loginBtn.click();}});
            loginBtn.addEventListener('click', async () => {const username = usernameInput.value.trim(); 
                                                            if (!username) { showAlert("è«‹è¼¸å…¥åå­—"); return; }
                                                            loginBtn.innerText = "è¼‰å…¥ä¸­..."; 
                                                            loginBtn.disabled = true;
                                                            try {const response = await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify({ username: username }) });
                                                                 const data = await response.json();
                                                                 if (data.result === "success") {localStorage.setItem('studyLandUser', username); 
                                                                                                 localStorage.setItem('userPermissions', data.permissions || "");
                                                                                                 localStorage.setItem('userNotionWeb', data.notionWeb || "");
                                                                                                 localStorage.setItem('userNotionPW', data.notionPW || "");
                                                                                                 showMainPage(username, data.permissions, data.notionWeb, data.notionPW);} else {
                                                                     showAlert("ç©å®¶ä¸å­˜åœ¨"); resetLoginBtn();}} catch (error) {
                                                                console.error('Login Error:', error); showAlert("é€£ç·šå¤±æ•—"); resetLoginBtn();}});
            function resetLoginBtn() {loginBtn.innerText = "é€²å…¥éŠæˆ²"; loginBtn.disabled = false;}
            // âš ï¸ éŒ¯èª¤è­¦å‘Š ALERT
            function showAlert(msg, emoji = "ğŸ™ğŸ»") {const emojiH1 = errorOverlay.querySelector('h1'); if (emojiH1) emojiH1.innerText = emoji; if (loginErrorText) loginErrorText.innerText = msg; errorOverlay.classList.remove('hidden');}
            // âŒ é—œé–‰å½ˆçª— CLOSE MODAL
            closeBtn.addEventListener('click', () => {errorOverlay.classList.add('hidden');});
            errorOverlay.addEventListener('click', (e) => {if (e.target === errorOverlay) {errorOverlay.classList.add('hidden');}});
            // âœ… è‡ªå‹•ç™»å…¥ AUTO LOGIN
            window.addEventListener('DOMContentLoaded', async () => {const savedName = localStorage.getItem('studyLandUser'); if (savedName) {
                                                                     const savedPermissions = localStorage.getItem('userPermissions'); const savedWeb = localStorage.getItem('userNotionWeb'); const savedPW = localStorage.getItem('userNotionPW');
                                                                     showMainPage(savedName, savedPermissions, savedWeb, savedPW);
                                                        try {const response = await fetch(SCRIPT_URL, {method: 'POST', body: JSON.stringify({username: savedName})});
                                                             const data = await response.json();
                                                             if (data.result === "success") {localStorage.setItem('userPermissions', data.permissions || ""); 
                                                                                             localStorage.setItem('userNotionWeb', data.notionWeb || "");
                                                                                             localStorage.setItem('userNotionPW', data.notionPW || "");
                                                                                             showMainPage(savedName, data.permissions, data.notionWeb, data.notionPW);
                                                                                             console.log("Permissions updated from server!");}}
                                                        catch (error) {console.error('Background Update Failed:', error);}}});
        
        // ğŸ“¤ ç™»å‡º LOGOUT
            // â‡ï¸ CONSTANT å¸¸æ•¸
            const logoutBtn = document.getElementById('logout-button'); const logoutModal = document.getElementById('logout-modal');
            const cancelLogout = document.getElementById('cancel-logout'); const confirmLogout = document.getElementById('confirm-logout');
            // ğŸ’¬ é¡¯ç¤ºå½ˆçª— SHOW MODAL
            logoutBtn.addEventListener('click', () => {logoutModal.classList.remove('hidden');});
            // âŒ é—œé–‰å½ˆçª— CLOSE MODAL
            cancelLogout.addEventListener('click', () => {logoutModal.classList.add('hidden');});
            logoutModal.addEventListener('click', (e) => {if (e.target === logoutModal) {logoutModal.classList.add('hidden');}});
            // âœ… ç¢ºå®šç™»å‡º CONFIRM LOGOUT
            confirmLogout.addEventListener('click', () => {localStorage.removeItem('studyLandUser'); localStorage.removeItem('userPermissions'); window.location.reload();});
    
        // ğŸ‘©ğŸ»â€ğŸ’» ä¸»é  MAIN PAGE
        function showMainPage(name, permissions, notionWeb, notionPW) {userDisplayName.textContent = name; loginOverlay.classList.add('hidden'); mainContent.classList.remove('hidden');
                                                                       window.currentUserNotionWeb = notionWeb || localStorage.getItem('userNotionWeb'); window.currentUserNotionPW = notionPW || localStorage.getItem('userNotionPW');
                                                                       // ğŸ•¹ï¸ éŠæˆ²å¸¸æ•¸ GAME CONSTANT
                                                                       const allGames = {'island': document.getElementById('btn-island'),
                                                                                         'downtown': document.getElementById('btn-downtown'),
                                                                                         'notion': document.getElementById('btn-notion'),
                                                                                         'writing': document.getElementById('btn-writing'),
                                                                                         'matching': document.getElementById('btn-matching'),
                                                                                         };
                                                                       // ğŸ™ˆ éš±è—æ‰€æœ‰éŠæˆ² HIDE ALL GAMES
                                                                       Object.values(allGames).forEach(el => el?.classList.add('hidden'));
                                                                       // ğŸ‘€ æª¢æŸ¥éŠæˆ²æ¬Šé™ CHECK GAME PERMISSIONS
                                                                       if (permissions) {const pList = permissions.split(','); 
                                                                                         pList.forEach(p => {const key = p.trim(); if (allGames[key]) allGames[key].classList.remove('hidden');});}
                                                                       window.scrollTo(0, 0);}

        // ğŸ“˜ å­¸ç¿’ç­†è¨˜ Notion
            // â‡ï¸ å¸¸æ•¸ CONSTANT
            const pwOverlay = document.getElementById('password-overlay'); const pwInput = document.getElementById('notion-pw-input');
            const pwCancel = document.getElementById('pw-cancel'); const pwConfirm = document.getElementById('pw-confirm');
            // ğŸ”’ å¯†ç¢¼ PASSWORD
            document.getElementById('btn-notion').addEventListener('click', () => {pwInput.value = ""; pwOverlay.classList.remove('hidden'); pwInput.focus();});
            pwCancel.addEventListener('click', () => {pwOverlay.classList.add('hidden');});
            pwOverlay.addEventListener('click', (e) => {if (e.target === pwOverlay) {pwOverlay.classList.add('hidden');}});
            pwConfirm.addEventListener('click', async () => {const inputVal = pwInput.value; const correctPW = String(window.currentUserNotionPW);
                                                             if (inputVal === correctPW) {
                                                                 if (window.currentUserNotionWeb) {pwConfirm.innerHTML = "æˆåŠŸ"; pwConfirm.style.backgroundColor = "#45b56e";
                                                                                                   pwConfirm.disabled = true; pwInput.disabled = true;
                                                                                                   setTimeout(() => {window.location.href = window.currentUserNotionWeb;}, 1200);}
                                                                 else {showAlert("æœªæœ‰å­¸ç¿’ç­†è¨˜", "ğŸ“š");}} else {showAlert("å¯†ç¢¼éŒ¯èª¤", "ğŸ”‘");}});
            pwInput.addEventListener('keypress', (e) => {if (e.key === 'Enter') pwConfirm.click();});
        
        // ğŸ«µğŸ» æ‰‹å‹¢ç¦æ­¢ DISABLE GESTURE
            // é¸å–åŠæ‹–å‹•
            document.querySelectorAll('.no-touch').forEach(el => {el.addEventListener('dragstart', (e) => e.preventDefault());});
            // å¤šæŒ‡ç¸®æ”¾
            const preventZoom = (e) => {if (e.touches?.length > 1 || (e.type === 'wheel' && (e.ctrlKey || e.metaKey))) {if (e.cancelable) e.preventDefault();}};
            ['touchstart', 'wheel', 'gesturestart'].forEach(type => {document.addEventListener(type, preventZoom, {passive: false});});
            // é›™æ“Šç¸®æ”¾
            let lastTouch = 0; document.addEventListener('touchend', (e) => {const now = Date.now(); if (now - lastTouch <= 300) e.preventDefault(); lastTouch = now;}, false);
            // æ²å‹•æ§åˆ¶
            let startY = 0; document.addEventListener('touchstart', (e) => {startY = e.touches[0].pageY;}, {passive: false});
                            document.addEventListener('touchmove', (e) => {const menu = document.getElementById('grid'); const path = e.composedPath();
                                                                           if (menu && path.includes(menu)) {const {scrollTop, scrollHeight, clientHeight} = menu;
                                                                                                             const deltaY = startY - e.touches[0].pageY;
                                                                                                             const isAtTop = scrollTop <= 0 && deltaY < 0; const isAtBottom = scrollTop + clientHeight >= scrollHeight && deltaY > 0;
                                                                                                             if (!isAtTop && !isAtBottom) return;}
                                                                           if (e.cancelable) e.preventDefault();},{ passive: false });

        // ğŸ“± æ‰‹æ©Ÿæ—‹è½‰æç¤º ORIENTATION NOTI
        function handleOrientationChange() {const warning = document.getElementById('orientation-noti'); 
                                            const isLandscape = window.innerWidth > window.innerHeight; const isMobileOrTablet = window.innerWidth < 1024;
                                            if (isLandscape && isMobileOrTablet) {warning.style.setProperty('display', 'flex', 'important');} else {warning.style.display = 'none';}}
        window.addEventListener('resize', handleOrientationChange);
        window.addEventListener('orientationchange', handleOrientationChange);
        handleOrientationChange();
    </script>
</body>
</html>
