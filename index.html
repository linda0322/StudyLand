<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Zung1 Man4</title>
    <link rel="icon" type="image/svg" href="https://lh3.googleusercontent.com/d/1arDtrA_TNi3vbHr7U0bnczMNy3Fz4T2G">
    <link rel="apple-touch-icon" href="https://lh3.googleusercontent.com/d/1361I_r_O_2PR498j6n2Km9TFwMa9XEhH">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ğŸï¸ æ•´é«” OVERALL */
        body {height: 100vh; width: 100vw; position: fixed; margin: 0; overflow: hidden; 
              overscroll-behavior: none; -webkit-user-select: none; touch-action: none;
              font-family: 'Noto Sans TC', sans-serif; background-color: #1dc5fd;            
              cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='50' height='50' style='font-size:36px'><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle'>â˜ï¸</text></svg>") 25 25, auto;
        }
            /* ğŸ™ï¸ èƒŒæ™¯ BACKGROUND */
            .bg-layer {position: fixed; inset: 0; z-index: -1; background-size: cover; background-position: center center; background-repeat: no-repeat;
                       background-image: url('https://lh3.googleusercontent.com/d/1WZPUn9UYK1xsLwXmo4QfSr1LG2-poCxc');}
            /* ğŸ“± æ‰‹æ©ŸèƒŒæ™¯ PHONE BACKGROUND */
            @media screen and (max-width: 600px) {.bg-layer {background-size: 100% auto; background-position: center bottom; background-image: url('https://lh3.googleusercontent.com/d/1OZe9V17SD7onLwgnE2IDiPG2D9KBjqAA');}}

        /* âš’ï¸ æ“ä½œ OPERATION */
            /* ğŸ”˜ æŒ‰éˆ• BUTTON */
            button {transition: transform 0.1s ease;} 
            .game-button:hover {background-color: rgba(255, 255, 255, 0.85); transform: translateY(-4px);}
            .game-button:active {background-color: rgba(255, 255, 255, 0.3); color: rgba(255, 255, 255, 1); transform: scale(0.95);}
            .game-button:active .game-title {color: white; -webkit-text-stroke: 0.5px white;}
        
        /* âš™ï¸ å…§éƒ¨çµæ§‹ INTERNAL */
            /* ğŸ‘¾ éŠæˆ²é¸å–® GAME MENU */
            .grid {-ms-overflow-style: none; scrollbar-width: none; -webkit-overflow-scrolling: touch; 
                   overscroll-behavior: contain; touch-action: pan-y;}
            .grid::-webkit-scrollbar {display: none;}
            .game-button {width: 100%; max-width: 160px; aspect-ratio: 1 / 1;
                          background-color: rgba(255, 255, 255, 0.95); border-radius: 30px; box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
                          display: flex; flex-direction: column; align-items: center; justify-content: center;
                          padding: 1rem; gap: 8px; margin: 0 auto;
                          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);}
            .game-icon-container {width: 100%; display: flex; align-items: center; justify-content: center;}
            .game-icon {width: 3rem; height: 3rem; object-fit: contain; border-radius: 0.75rem; pointer-events: none;}
            .game-title {font-family: 'Cubic11', sans-serif; color: #64748b; font-size: 0.875rem; -webkit-text-stroke: 0.5px currentColor; paint-order: stroke fill; text-align: center; letter-spacing: 0.05em;}
                /* ğŸ“± æ‰‹æ©Ÿç‰ˆ LAYOUT */
                @media screen and (max-width: 600px) {.grid {gap: 20px 15px; padding: 12px;}
                                                      .game-button {overflow: visible; background-color: transparent !important; box-shadow: none !important; 
                                                                    display: flex; flex-direction: column; align-items: center;
                                                                    padding: 3px !important;}
                                                      .game-icon-container {width: 100%; aspect-ratio: 1 / 1; overflow: hidden;
                                                                            background-color: white; border-radius: 16px; opacity: 0.9; border: 2px rgba(255, 255, 255, 0.3);
                                                                            display: flex; align-items: center; justify-content: center;
                                                                            margin-bottom: 8px;}
                                                      .game-icon {width: 100% !important; height: 100% !important; object-fit: cover; border-radius: 0;}
                                                      .game-title {font-size: 0.8rem; color: white !important; -webkit-text-stroke: 0.5px white !important; white-space: nowrap;}
                                                      .game-button:active {transform: scale(0.85);}
                                                      .game-button:active .game-title {color: white; -webkit-text-stroke: 0.5px;}}
            /* ğŸ”’ å¯†ç¢¼ PASSWORD */
            #notion-pw-input {font-size: 1rem; letter-spacing: 0.3em; text-align: center; vertical-align: middle;}
            #notion-pw-input::placeholder {font-size: 1rem; -webkit-text-stroke: 0.5px currentColor; text-indent: 0; letter-spacing: normal;}     
            @media screen and (max-width: 600px) {#notion-pw-input {font-size: 0.9rem; letter-spacing: 0.2em;}}
    </style>
</head>
<body>
    <!-- ğŸ™ï¸ èƒŒæ™¯ BACKGROUND -->
    <div class="bg-layer"></div>
   
    <!-- ğŸ“² æ‰‹æ©Ÿæ—‹è½‰æç¤º ORIENTATION NOTI -->
    <div id="orientation-noti-portrait">
        <div class="animate-phone-portrait w-20 h-20 flex items-center justify-center mb-6">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>
        </div>
        <h2 class="font-cubic text-white text-xl thick-border tracking-wider">æ—‹è½‰è¢å¹•ä»¥ç¹¼çºŒéŠæˆ²</h2>
    </div>
    
    <!-- ğŸ“¥ ç™»å…¥ LOGIN -->
        <div id="login-overlay" class="no-touch fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex flex-col justify-center items-center p-6">
            <!-- ğŸ’¬ -->
            <div class="no-touch w-full max-w-xs bg-white rounded-[40px] shadow-2xl flex flex-col text-center items-center p-8">
                <img src="https://lh3.googleusercontent.com/d/1dCdxRN0oNjOz5lg7rwajTtYZb077zePp" alt="NPC" class="no-touch pointer-events-none w-20 h-20 mb-6">
                <h2 class="font-cubic text-slate-700 text-xl thick-border tracking-wider mb-4">ç™»å…¥</h2>
                <input type="text" id="username-input" placeholder="è«‹è¼¸å…¥ä½ çš„åå­—" class="w-full border-2 border-slate-100 rounded-2xl font-cubic thin-border text-center px-4 py-4 mb-4 outline-none focus:border-[#38C0FF] transition-all">
                <button id="login-button" class="no-touch w-full bg-[#38C0FF] rounded-2xl font-cubic text-white thin-border px-4 py-4 hover:bg-[#2da9e6] transition-all">é€²å…¥éŠæˆ²</button>
            </div>
        </div>
    
    <!-- âš ï¸ éŒ¯èª¤è­¦å‘Š ALERT -->
        <div id="error-modal" class="no-touch hidden fixed inset-0 z-[300] bg-transparent flex flex-col justify-center items-center p-6">
            <div class="no-touch max-w-xs bg-slate-200/70 backdrop-blur-sm rounded-[30px] shadow-md relative flex flex-col text-center items-center p-8">
                <button id="error-close" class="no-touch w-12 h-12 absolute top-4 right-2 text-slate-400 flex text-center justify-center hover:text-slate-600 hover:bg-transparent active:bg-transparent transition-all"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x-icon lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                <h1 class="text-4xl mb-4">ğŸ™ğŸ»</h1>
                <h2 id="login-error" class="font-cubic text-slate-700 text-lg thick-border tracking-wider">...</h2>
            </div>
        </div>

    <!-- ğŸ’¬ğŸ”’ ç­†è¨˜å¯†ç¢¼ PASSWORD INPUT -->
        <div id="password-modal" class="no-touch hidden fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm flex justify-center items-center p-6">
            <div class="no-touch w-full max-w-xs bg-white rounded-[40px] shadow-2xl relative flex flex-col text-center items-center p-8">
                <h1 class="text-4xl mb-4">ğŸ”’</h1>
                <input type="password" id="notion-pw-input" placeholder="è«‹è¼¸å…¥ç­†è¨˜å¯†ç¢¼" class="w-full border-2 border-slate-100 rounded-2xl font-cubic thin-border text-center px-4 py-4 mb-4 outline-none focus:border-[#38C0FF] transition-all">
                <div class="w-full flex gap-4">
                    <button id="notion-pw-cancel" class="no-touch flex-1 py-3 bg-slate-200 rounded-2xl font-cubic text-slate-600 thin-border hover:bg-slate-300 transition-all">å–æ¶ˆ</button>
                    <button id="notion-pw-confirm" class="no-touch flex-1 py-3 bg-[#38C0FF] rounded-2xl font-cubic text-white thin-border hover:bg-[#2da9e6] transition-all">ç¢ºå®š</button>
                </div>
            </div>
        </div>

    <!-- ğŸ’¬ğŸ“¤ ç™»å‡º LOGOUT -->
        <div id="logout-modal" class="no-touch hidden fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm flex justify-center items-center p-6">
            <div class="no-touch w-full max-w-xs bg-white rounded-[40px] shadow-2xl flex flex-col text-center items-center p-8 ">
                <h2 class="font-cubic text-slate-700 text-xl thick-border tracking-wider mb-4">é€€å‡ºéŠæˆ²</h2>
                <div class="w-full flex gap-4">
                    <button id="cancel-logout" class="no-touch flex-1 py-3 bg-slate-200 rounded-2xl font-cubic text-slate-600 thin-border hover:bg-slate-300 transition-all">å–æ¶ˆ</button>
                    <button id="confirm-logout" class="no-touch flex-1 py-3 bg-[#38C0FF] rounded-2xl font-cubic text-white thin-border hover:bg-[#2da9e6] transition-all">ç™»å‡º</button>
                </div>
            </div>
        </div>

    <!-- ğŸ‘©ğŸ»â€ğŸ’» ä¸»è¦ MAIN -->
    <main id="main-content" class="hidden container flex flex-col items-center mx-auto px-8 py-8">
        <!-- ğŸ” é ‚æ¬„ TOP --><nav class="w-full max-w-[550px] flex justify-between mb-8">
            <!-- â¬…ï¸ å·¦é‚Š LEFT-->
            <div class="flex items-center gap-2">
                <!-- ğŸ“› ç”¨æˆ·åç¨± USERNAME -->
                <div class="glass-panel rounded-full shadow-md flex items-center px-4 py-1.5 gap-2">
                    <span class="font-cubic text-slate-500 text-[10px] thin-border tracking-wider">ç©å®¶</span><span id="user-display-name" class="font-cubic text-slate-700 text-sm thin-border">è¼‰å…¥ä¸­...</span>
                </div>
                <!-- ğŸ”˜ğŸ“¤ ç™»å‡ºæŒ‰éˆ• LOGOUT BUTTON -->
                <button id="logout-button" class="no-touch glass-panel rounded-full shadow-md text-red-600 p-2" title="ç™»å‡º"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></button>
            </div>
        </nav>
        <!-- ğŸ¤– NPC å‹•ç•« ANIMATION -->
        <header class="flex flex-col items-center text-center mb-6">
            <div class="relative mb-4">
                <img src="https://lh3.googleusercontent.com/d/1dCdxRN0oNjOz5lg7rwajTtYZb077zePp" alt="NPC" class="npc-float no-touch pointer-events-none w-[140px] h-auto drop-shadow-md">
                <div class="animate-text-float absolute -top-1 -right-3 font-cubic text-white text-[22px] thick-border text-shadow-md tracking-widest">GO!</div>
            </div>
        </header>
        <!-- ğŸ‘¾ éŠæˆ²é¸å–® GAME MENU -->
        <div id="grid" class="w-full max-w-[600px] max-h-[60vh] overflow-y-auto grid grid-cols-3 md:grid-cols-4 gap-6 px-6 pt-6 pb-10 -mt-6">            
            <!-- ğŸªª ç©å®¶ USER -->
                <!-- ğŸï¸ æˆ‘çš„å³¶å¶¼ ISLAND -->
                <a id="island-button" href="user/islandmode.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1x9g9cC2Z3YOQXjplPElgLOtBuKixb6lD" alt="æˆ‘çš„å³¶å¶¼" class="no-touch game-icon"></div>
                    <h3 class="game-title">æˆ‘çš„å³¶å¶¼</h3>
                </a>
                <!-- ğŸ›ï¸ å¤§è¡—å°å·· DOWNTOWN -->
                <a id="downtown-button" href="user/downtown.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1dEOyNT7D5TQfiV0i2BbfLR6nQIcEylP1" alt="å¤§è¡—å°å··" class="no-touch game-icon"></div>
                    <h3 class="game-title">å¤§è¡—å°å··</h3>
                </a>
                <!-- ğŸ’ æˆ‘çš„è¡Œæ LUGGAGE -->
                <a id="luggage-button" href="user/luggage.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1ouM3LfUpd4WsJAnytkoBBa0UPxpVeBUJ" alt="æˆ‘çš„è¡Œæ" class="no-touch game-icon"></div>
                    <h3 class="game-title">æˆ‘çš„è¡Œæ</h3>
                </a>
                <!-- ğŸ“˜ å­¸ç¿’ç­†è¨˜ NOTION -->
                <button id="notion-button" class="no-touch game-button hidden">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1530dnP0UbRAxDQaxT1Ry85Fr2Xk1U05d" alt="å­¸ç¿’ç­†è¨˜" class="no-touch game-icon"></div>
                    <h3 class="game-title">å­¸ç¿’ç­†è¨˜</h3>
                </button>
            <!-- ğŸ‘¾ éŠæˆ² GAME -->
                <!-- âœğŸ» å–®å­—ç·´ç¿’ WRITING -->
                <a id="writing-button" href="game/writing.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1dJz8_GceDg8TAGf3ngz85sHSBlLTbQe5" alt="å–®å­—ç·´ç¿’" class="no-touch game-icon"></div>
                    <h3 class="game-title">å–®å­—ç·´ç¿’</h3>
                </a>
                <!-- ğŸƒ åœ–æ–‡é…å° MATCHING -->
                <a id="btn-matching" href="game/matching.html" class="no-touch game-button">
                    <div class="game-icon-container"><img src="https://lh3.googleusercontent.com/d/1XlgAge1T0jE8lxzBtuvvIqvPUMes5nPb" alt="åœ–æ–‡é…å°" class="no-touch game-icon"></div>
                    <h3 class="game-title">åœ–æ–‡é…å°</h3>
                </a>          
        </div>
    </main> 

<script src="common.js"></script>
<script>
    // =========================================
    // ğŸŒ GAS
    // =========================================
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwEumd1LFQrap1grNNqL9gywqdlttz9NEIVpRGGtkCTxTWc0Rmzzf1g3OB3c6KCp1iD/exec'; 

    // =========================================
    // ğŸŒ³ DOM çµ±ä¸€ç®¡ç†
    // =========================================
    const DOM = {
        // ğŸ’¬ å½ˆçª— Modal
        errorModal: document.getElementById('error-modal'),
        passwordModal: document.getElementById('password-modal'),
        logoutModal: document.getElementById('logout-modal'),
        // âš ï¸ è­¦å‘Š Alert
        loginErrorText: document.getElementById('login-error'),
        errorCloseBtn: document.getElementById('error-close'),
        // ğŸ“¥ ç™»å…¥ Login
        loginOverlay: document.getElementById('login-overlay'),
        usernameInput: document.getElementById('username-input'),
        loginBtn: document.getElementById('login-button'),
        userDisplayName: document.getElementById('user-display-name'),
        mainContent: document.getElementById('main-content'),
        // ğŸ“¤ ç™»å‡º Logout
        logoutBtn: document.getElementById('logout-button'),
        cancelLogout: document.getElementById('cancel-logout'),
        confirmLogout: document.getElementById('confirm-logout'),
        // ğŸ“˜ Notion
        pwInput: document.getElementById('notion-pw-input'),
        pwCancel: document.getElementById('notion-pw-cancel'),
        pwConfirm: document.getElementById('notion-pw-confirm'),
        notionBtn: document.getElementById('notion-button'),
        // ğŸ•¹ï¸ éŠæˆ²é¸å–® Game Menu
        grid: document.getElementById('grid'),
        games: {
            'island': document.getElementById('island-button'),
            'downtown': document.getElementById('downtown-button'),
            'luggage': document.getElementById('luggage-button'),
            'notion': document.getElementById('notion-button'),
            'writing': document.getElementById('writing-button'),
            'matching': document.getElementById('btn-matching'),
        }
    };
    
    // =========================================
    // ğŸ’¬âš ï¸ å½ˆçª—åŠè­¦å‘Š Modal & Alert
    // =========================================
    const showModal = (modal) => modal.classList.remove('hidden');
    const hideModal = (modal) => modal.classList.add('hidden');
    [DOM.errorModal, DOM.passwordModal, DOM.logoutModal].forEach(modal => {modal.addEventListener('click', (e) => {if (e.target === modal) hideModal(modal);});});
    DOM.errorCloseBtn.addEventListener('click', () => hideModal(DOM.errorModal));
    DOM.pwCancel.addEventListener('click', () => hideModal(DOM.passwordModal));
    DOM.cancelLogout.addEventListener('click', () => hideModal(DOM.logoutModal));
    
    function showAlert(msg, emoji = "ğŸ™ğŸ»") {
        const emojiH1 = DOM.errorModal.querySelector('h1');
        if (emojiH1) emojiH1.innerText = emoji;
        if (DOM.loginErrorText) DOM.loginErrorText.innerText = msg;
        showModal(DOM.errorModal);
    }

    // =========================================
    // ğŸ“¥ ç™»å…¥ LOGIN
    // =========================================
    
    function resetLoginBtn() {DOM.loginBtn.innerText = "é€²å…¥éŠæˆ²"; DOM.loginBtn.disabled = false;}
    
    async function processLogin(username, isAutoLogin = false) {
        if (!username) {showAlert("è«‹è¼¸å…¥åå­—"); return;}
        if (!isAutoLogin) {DOM.loginBtn.innerText = "è¼‰å…¥ä¸­..."; DOM.loginBtn.disabled = true;}
        try {const response = await fetch(SCRIPT_URL, {method: 'POST', body: JSON.stringify({username: username})});
             const data = await response.json();
             if (data.result === "success") {
                localStorage.setItem('userID', username); 
                localStorage.setItem('userPermissions', data.permissions || "");
                localStorage.setItem('userNotionWeb', data.notionWeb || "");
                localStorage.setItem('userNotionPW', data.notionPW || "");
                showMainPage(username, data.permissions, data.notionWeb, data.notionPW);
            } else if (!isAutoLogin) {
                showAlert("ç©å®¶ä¸å­˜åœ¨"); 
                resetLoginBtn();
            }
        } catch (error) {
            console.error('Login Error:', error);
            if (!isAutoLogin) {
                showAlert("é€£ç·šå¤±æ•—"); 
                resetLoginBtn();
            }
        }
    }
    DOM.loginBtn.addEventListener('click', () => processLogin(DOM.usernameInput.value.trim()));
    DOM.usernameInput.addEventListener('keypress', (e) => {if (e.key === 'Enter') DOM.loginBtn.click();});

    window.addEventListener('DOMContentLoaded', () => {
        const savedName = localStorage.getItem('userID');
        if (savedName) {
            const savedPermissions = localStorage.getItem('userPermissions'); 
            const savedWeb = localStorage.getItem('userNotionWeb'); 
            const savedPW = localStorage.getItem('userNotionPW');
            showMainPage(savedName, savedPermissions, savedWeb, savedPW);
            processLogin(savedName, true);
        }
    });

    // =========================================
    // ğŸ“¤ ç™»å‡º LOGOUT
    // =========================================
    DOM.logoutBtn.addEventListener('click', () => showModal(DOM.logoutModal));
    DOM.confirmLogout.addEventListener('click', () => {
        localStorage.removeItem('userID'); 
        localStorage.removeItem('userPermissions'); 
        window.location.reload();
    });

    // =========================================
    // ğŸš€ é¡¯ç¤ºä¸»ç•«é¢ SHOW MAIN
    // =========================================    
    function showMainPage(name, permissions, notionWeb, notionPW) {
        DOM.userDisplayName.textContent = name; 
        hideModal(DOM.loginOverlay); 
        DOM.mainContent.classList.remove('hidden');
        window.currentUserNotionWeb = notionWeb || localStorage.getItem('userNotionWeb'); 
        window.currentUserNotionPW = notionPW || localStorage.getItem('userNotionPW');
        
        Object.values(DOM.games).forEach(el => el?.classList.add('hidden'));
        
        if (permissions) {
            permissions.split(',').forEach(p => {
                const key = p.trim(); 
                if (DOM.games[key]) DOM.games[key].classList.remove('hidden');
            });
        }
        window.scrollTo(0, 0);
    }

    // =========================================
    // ğŸ“˜ Notion
    // =========================================   
    DOM.notionBtn.addEventListener('click', () => {
        DOM.pwInput.value = ""; 
        showModal(DOM.passwordModal); 
        DOM.pwInput.focus();
    });

    DOM.pwConfirm.addEventListener('click', () => {
        const inputVal = DOM.pwInput.value; 
        const correctPW = String(window.currentUserNotionPW);
        if (inputVal === correctPW) {
            if (window.currentUserNotionWeb) {
                DOM.pwConfirm.innerHTML = "æˆåŠŸ"; 
                DOM.pwConfirm.style.backgroundColor = "#45b56e"; 
                DOM.pwConfirm.disabled = true; 
                DOM.pwInput.disabled = true;
                setTimeout(() => { window.location.href = window.currentUserNotionWeb; }, 1200);
            } else {
                showAlert("æœªæœ‰å­¸ç¿’ç­†è¨˜", "ğŸ“š");
            }
        } else {
            showAlert("å¯†ç¢¼éŒ¯èª¤", "ğŸ”‘");
        }
    });
    DOM.pwInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') DOM.pwConfirm.click(); });

    // ==============================================
    // ğŸ«µğŸ» æ‰‹å‹¢ç¦æ­¢è£œå……ï¼šæ²å‹•æ§åˆ¶ DISABLE GESTURE: SCROLL
    // ==============================================    
    let startY = 0; 
    document.addEventListener('touchstart', (e) => {
        startY = e.touches[0].pageY;
    }, {passive: false});
    document.addEventListener('touchmove', (e) => {
        const path = e.composedPath();
        if (DOM.grid && path.includes(DOM.grid)) {
            const {scrollTop, scrollHeight, clientHeight} = DOM.grid;
            const deltaY = startY - e.touches[0].pageY;
            const isAtTop = scrollTop <= 0 && deltaY < 0; 
            const isAtBottom = scrollTop + clientHeight >= scrollHeight && deltaY > 0;
            if (!isAtTop && !isAtBottom) return; // é¸å–®ä¸­é–“å…è¨±æ»‘å‹•
        }
        if (e.cancelable) e.preventDefault();
    },{ passive: false });

</script>
</body>
</html>
